\documentclass[conference]{IEEEtran}
\IEEEoverridecommandlockouts

\usepackage{cite}
\usepackage{amsmath,amssymb,amsfonts}
\usepackage{algorithmic}
\usepackage{graphicx}
\usepackage{textcomp}
\usepackage{xcolor}
\usepackage{hyperref}

\begin{document}

\title{Multi-Target Trading Automation with Deep Q Learning}

\author{
  \IEEEauthorblockN{Yan-Fu Chen}
  \IEEEauthorblockA{
    \textit{Dept. of Computer Science} \\
    \textit{National Tsing-Hua University}\\
    Hsinchu, Taiwan \\
    aaaronyanfu@gmail.com
  }
  \and
  \IEEEauthorblockN{Sheng-You Chien}
  \IEEEauthorblockA{
    \textit{Dept. of Computer Science} \\
    \textit{National Tsing-Hua University}\\
    Hsinchu, Taiwan \\
    s99086tobby@gmail.com
  }
  \and
  \IEEEauthorblockN{Yi-Ning Chang}
  \IEEEauthorblockA{
    \textit{Dept. of Computer Science} \\
    \textit{National Tsing-Hua University}\\
    Hsinchu, Taiwan \\
    changyn@gapp.nthu.edu.tw
  }
  \and
  \IEEEauthorblockN{Jie-Hung Chen}
  \IEEEauthorblockA{
    \textit{Dept. of Computer Science} \\
    \textit{National Tsing-Hua University}\\
    Hsinchu, Taiwan \\
    jiehongchen726@gmail.com
  }
  \and
  \IEEEauthorblockN{Yi-Hsueh Chu}
  \IEEEauthorblockA{
    \textit{Dept. of Computer Science} \\
    \textit{National Tsing-Hua University}\\
    Hsinchu, Taiwan \\
    ethan111062332@gapp.nthu.edu.tw
  }
  \and
  \IEEEauthorblockN{Bo-Yi Mao}
  \IEEEauthorblockA{
    \textit{Dept. of Computer Science} \\
    \textit{National Tsing-Hua University}\\
    Hsinchu, Taiwan \\
    dogeon188@gapp.nthu.edu.tw
  }
}

\maketitle

\begin{abstract}

  % 毛

\end{abstract}

\begin{IEEEkeywords}
  deep reinforcement learning, deep Q-network, stock trading,
  algorithmic trading
\end{IEEEkeywords}

\section{Introduction}

An automatic, algorithmic way of stock trading, leveraging the
swiftness and accuracy of computer systems, has long been a persuit
of many. With the rise of machine learning and deep learning, the
possibility of using these technologies to predict stock prices and
make trading decisions has become a reality.

% 毛

\section{Related Works}

Even though the Efficient Market Hypothesis (EMH) posits that stock
prices reflect all available information, and thus cannot be
predicted consistently, many studies have shown that stock prices
exhibit predictable patterns and can be forecasted to some extent.
Various approaches have been proposed, differing in learning
algorithms and objectives. In recent years, deep reinforcement
learning (DRL) has gained significant attention due to its ability to
learn complex trading strategies directly from market data.

\subsection{Stock Price Prediction}

Most studies have focused on predicting stock prices using various
machine learning models. Traditional statistical methods such as
ARIMA and GARCH have been widely used for time series forecasting.
However, financial time series are often non-stationary and exhibit
volatility changes, making it challenging to capture their underlying
patterns with smoothened models.

With the advent of machine learning and deep learning, more
sophisticated models have been developed. Convolutional Neural
Networks (CNNs) and Recurrent Neural Networks (RNNs), including Long
Short-Term Memory (LSTM) networks, have shown promising results in
stock price prediction. These models can automatically extract
relevant features from raw data and capture temporal dependencies,
making them well-suited for financial time series analysis.

Support Vector Machines (SVMs) have been applied to stock predictions
in many works. Phayung et al. \cite{phayung2013} applied Support
Vector Regression (SVR) and combines different windowing functions to
predict stock prices. Their model showed good performance in
predicting short-term stock prices. Similarly, Tripathy
\cite{tripathy2019} demonstrated that SVMs are effective in highly
volatile markets, and it performs better in short-term and
medium-term predictions compared to long-term predictions. Also,
Zhang et al. \cite{zhang2017} proposed a periodic updating SVM model
that can adapt to changing market conditions, which showed
competitive performance compared to the random walk model proposed by the EMH.

Zhang et al. \cite{zhang2017} proposed a State Frequency Memory (SFM)
recurrent neural network to capture the multi-frequency trading
patterns in stock prices. They demonstrated that their model showed
competitive performance compared to traditional methods. Fischer and
Krauss \cite{fischer2018} applied LSTM networks to rank stocks based
on their future returns and showed that their model could outperform
traditional ranking methods.

More advanced models have also been applied to stock price prediction
in recent years. Feng et al. \cite{feng2019an} proposed an
adversarial learning framework that outperformed SOTA methods in
terms of prediction accuracy. Koa et al. \cite{koa2023} developed a
combination of Variational Autoencoders (VAEs) and diffusion models
to capture the latent structure of financial time series. Gao et al.
\cite{gao2023} proposed a transformer-based model that outperformed
traditional methods in terms of portfolio returns and Sharpe ratios.

\subsection{Algorithmic Trading}

Despite these advancements in stock price prediction, they are
usually evaluated on historical data and do not consider the trading
strategy's performance in real-world scenarios. Such problem has been
addressed by Feng et al. \cite{feng2019rank} who proposed an improved
ranking model that can generate trading signals based on the
predicted stock returns. Importantly, they considered the
relationship between different stocks that conveys valuable
information for trading decisions.

% (RL & DQN) 朱
% Summarize the works that use RL and DQN for stock trading

\section{Methodology}

\subsection{Multi-Target Trading Architecture}

% 甫 桀
% Introduce the architecture of RL training and trading system

\subsection{Policy Network}

% 甫 桀
% Introduce the policy networks used

\section{Experiments}

\subsection{Dataset}

% 朱 毛
% Introduce the dataset used, and how it is preprocessed

\subsection{Evaluation Metrics}

% 張 簡
% Introduce the evaluation metrics used
Backtesting is a common method to evaluate the performance of a predictive model in the financial domain.
It simulates the trading strategy on historical data to estimate the strategy's performance.

We use FinRL \cite{liu2022finrldeepreinforcementlearning}, a powerful deep reinforcement learning library to backtest our trading strategy.
Our reinforcement learning model is compared with the buy-and-hold strategy, which buys and holds the stock for the entire trading period, on the DJI Index.
DJI Index is a stock market index that measures the stock performance of 30 large companies listed on stock exchanges in the United States.

Our models are evaluated based on the following metrics:
\begin{itemize}
  \item Annualized Return: The annualized return of the trading strategy.
  \item Cumulative Return: The cumulative return of the trading strategy.
  \item Maximum Drawdown: The maximum loss from a peak (highest point) to a trough (lowest point) of a trading strategy.
  \item Sharpe Ratio: As measure of the risk-adjusted return of the trading strategy, the Sharpe ratio is defined as:
    \begin{equation}
      \text{Sharpe Ratio} = \frac{E[R_p - R_f]}{\sigma_p}
    \end{equation}
    where $R_p$ is the asset return of the trading strategy, $\sigma_p$ is the standard deviation of the asset excess return, and $R_f$ is the risk-free return (such as a U.S. Treasury security).
    Therefore, The Sharpe ratio characterizes how well the return of an asset compensates the investor for the risk taken.
  \item Calmar Ratio:
    The Calmar ratio is defined as the ratio of the annualized return to the maximum drawdown of the trading strategy:
    \begin{equation}
      \text{Calmar Ratio} = \frac{\text{Annualized Return}}{\text{Maximum Drawdown}}
    \end{equation}
    Compared to the Sharpe ratio, the Calmar ratio focuses on the downside risk of the trading strategy.

  \item Annualized Volatility: The annualized volatility of the trading strategy.
  \item Sortino Ratio: Sortino ratio is a variation of the Sharpe ratio that only considers the downside risk of the trading strategy. It is defined as:
    \begin{equation}
      \text{Sortino Ratio} = \frac{E[R_p - R_f]}{\sigma_d}
    \end{equation}
    where $\sigma_d$ is the standard deviation of the asset downside return.
\end{itemize}

\subsection{Results}

% 張 簡
% Discuss the results of the experiments

\begin{table}[htbp]
  \centering
  \caption{Performance comparison of the strategies on our dataset.}
  \begin{tabular}{|c|c|c|c|c|}
    \hline
    \textbf{Evaluation} & \multicolumn{4}{|c|}{\textbf{Model}} \\
    \cline{2-5}
    \textbf{Metric} & \textit{\textbf{DQN}} & \textit{\textbf{A2C}} & \textit{\textbf{PPO}} & \textit{\textbf{Buy-and-Hold}} \\
    \hline
    Annualized Return & \underline{0.3122} & 0.2119 & 0.0192 & 0.2387 \\
    \hline
    Cumulative Return & \underline{0.3969} & 0.2667 & 0.0237 & 0.3001 \\
    \hline
    Maximum Drawdown & -0.1807 & -0.1549 & -0.2074 & \underline{-0.0678} \\
    \hline
    Sharpe Ratio & 1.4614 & 1.0595 & 0.1955 & \underline{2.1126} \\
    \hline
    Calmar Ratio & 1.7389 & 1.3682 & 0.0925 & \underline{3.5230} \\
    \hline
    Annualized Volatility & 0.1999 & 0.2012 & 0.1941 & \underline{0.1043} \\
    \hline
    Sortino Ratio & 1.5270 & 1.4550 & 0.2661 & \underline{3.2108} \\
    \hline
  \end{tabular}
  % footnote
  \begin{tabular}{p{0.45\textwidth}}
    \textit{Note:} The best performance for each metric is underlined.
  \end{tabular}
  \label{tab:results}
\end{table}

\begin{figure}[htbp]
  \centerline{\includegraphics[width=0.4\textwidth]{figs/results.png}}
  \caption{Performance comparison of the strategies on our dataset.}
  \label{fig:returns}
\end{figure}

\section{Conclusion}

% 毛
% (1) Summarize the contributions of the paper
% (2) Discuss the limitations of the current work
% (3) Suggest future research directions

\section{Data and Code Availability}

Stock price data used in this study is publicly available from Yahoo! Finance \cite{yahoofinance}, and is obtained using the yfinance Python library \cite{yfinance}.

Cryptocurrency price data is obtained from the Binance API \cite{binanceapi} using the ccxt Python library \cite{ccxt}.

All code for data fetching, data preprocessing, model training, and evaluation is available at \url{https://github.com/Dogeon188/StockSense}. Any updates or changes to the code will be reflected in the GitHub repository.

\section{Author Contribution Statements}

% 毛

\bibliographystyle{IEEEtran}
\bibliography{refs}

\end{document}
